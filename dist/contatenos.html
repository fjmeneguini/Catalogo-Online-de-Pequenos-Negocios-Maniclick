<!-- ============================================================
     P√ÅGINA CONTATE-NOS | ManiClick
     ============================================================ -->
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contate-nos - ManiClick</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- ============================================================
       CABE√áALHO E NAVEGA√á√ÉO
       ============================================================
       Inclui logotipo, menus de navega√ß√£o (desktop e mobile) e bot√£o de agendamento.
       ============================================================ -->
  <header>
    <div class="header-container">
      <div class="logo">
        <h1>ManiClick</h1>
        <span class="subtitulo">Sandra Almeida - Manicure</span>
      </div>
      <!-- Menu hamburguer mobile -->
      <button class="menu-hamburguer" id="menu-hamburguer" aria-label="Abrir menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <!-- Menu mobile -->
      <nav class="menu-mobile" id="menu-mobile">
        <button class="fechar-menu" id="fechar-menu" aria-label="Fechar menu">&times;</button>
        <ul>
          <li><a href="index.html">In√≠cio</a></li>
          <li class="submenu-servicos">
            <a href="#" id="abrir-submenu-mobile">Servi√ßos &#9662;</a>
            <ul class="submenu-lista">
              <li><a href="alongamentofibradevidro.html">Alongamento Fibra de Vidro</a></li>
              <li><a href="blindagemdeunhas.html">Blindagem de Unhas</a></li>
              <li><a href="decoracaoartistica.html">Decora√ß√£o Art√≠stica</a></li>
              <li><a href="esmaltacaosimples.html">Esmalta√ß√£o Simples</a></li>
              <li><a href="francesinha.html">Francesinha</a></li>
              <li><a href="hidratacaodecuticulas.html">Hidrata√ß√£o de Cut√≠culas</a></li>
              <li><a href="peemao.html">P√© e M√£o</a></li>
              <li><a href="remocaodegelfibra.html">Remo√ß√£o de Gel/Fibra</a></li>
              <li><a href="spadospes.html">Spa dos P√©s</a></li>
              <li><a href="unhadecorada.html">Unha Decorada</a></li>
              <li><a href="unhasemgel.html">Unhas em Gel</a></li>
              <li><a href="unhasinfantis.html">Unhas Infantis</a></li>
            </ul>
          </li>
          <li><a href="sobre.html">Sobre</a></li>
          <li><a href="index.html#avaliacoes">Avalia√ß√µes</a></li>
          <li><a href="contatenos.html">Contate-nos</a></li>
          <li id="menu-perfil-mobile" style="display:none;">
            <a href="#" onclick="abrirPerfil(); return false;">Perfil</a>
          </li>
          <li id="menu-login-mobile">
            <a href="login.html">Entrar/Cadastrar</a>
          </li>
          <li><a href="index.html#agendar" class="btn-agendar">Agende seu hor√°rio</a></li>
        </ul>
      </nav>
      <!-- Menu desktop -->
      <nav>
        <ul class="menu-principal">
          <li><a href="index.html">In√≠cio</a></li>
          <li class="submenu-servicos">
            <a href="index.html#servicos">Servi√ßos</a>
            <ul class="submenu-lista">
              <li><a href="alongamentofibradevidro.html">Alongamento Fibra de Vidro</a></li>
              <li><a href="blindagemdeunhas.html">Blindagem de Unhas</a></li>
              <li><a href="decoracaoartistica.html">Decora√ß√£o Art√≠stica</a></li>
              <li><a href="esmaltacaosimples.html">Esmalta√ß√£o Simples</a></li>
              <li><a href="francesinha.html">Francesinha</a></li>
              <li><a href="hidratacaodecuticulas.html">Hidrata√ß√£o de Cut√≠culas</a></li>
              <li><a href="peemao.html">P√© e M√£o</a></li>
              <li><a href="remocaodegelfibra.html">Remo√ß√£o de Gel/Fibra</a></li>
              <li><a href="spadospes.html">Spa dos P√©s</a></li>
              <li><a href="unhadecorada.html">Unha Decorada</a></li>
              <li><a href="unhasemgel.html">Unhas em Gel</a></li>
              <li><a href="unhasinfantis.html">Unhas Infantis</a></li>
            </ul>
          </li>
          <li><a href="sobre.html">Sobre</a></li>
          <li><a href="index.html#avaliacoes">Avalia√ß√µes</a></li>
          <li><a href="contatenos.html">Contate-nos</a></li>
          <li id="menu-perfil" style="display:none;">
            <a href="#" onclick="abrirPerfil(); return false;">Perfil</a>
          </li>
          <li id="menu-login">
            <a href="login.html">Entrar/Cadastrar</a>
          </li>
          <li><a href="index.html#agendar" class="btn-agendar">Agende seu hor√°rio</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- ============================================================
       CONTE√öDO PRINCIPAL - FORMUL√ÅRIO DE CONTATO
       ============================================================
       Exibe o formul√°rio para o usu√°rio enviar mensagem.
       ============================================================ -->
  <main>
    <section class="contato" id="contato">
      <div class="contato-card">
        <h2>Contate-nos</h2>
        <form id="form-contatenos" action="https://formsubmit.co/sandraalmeidamanicure@gmail.com" method="POST">
          <input type="hidden" name="_subject" value="Nova mensagem do site ManiClick">
          <input type="hidden" name="_replyto" value="">
          <label for="nome">Nome:</label>
          <input type="text" id="nome" name="nome" required>
          <label for="email">E-mail:</label>
          <input type="email" id="email" name="email" required>
          <label for="mensagem">Mensagem:</label>
          <textarea id="mensagem" name="mensagem" rows="4" required></textarea>
          <button type="submit" class="btn">Enviar</button>
        </form>
      </div>
    </section>
  </main>

  <!-- ============================================================
       RODAP√â PADR√ÉO
       ============================================================
       Exibe informa√ß√µes de contato, redes sociais e direitos autorais.
       ============================================================ -->
  <footer>
    <div class="container">
      <div class="contato" id="contato-info"></div>
      <div class="icones" id="icones"></div>
      <p class="final">¬© 2025 ManiClick</p>
    </div>
  </footer>

  <!-- ============================================================
       BOT√ïES FLUTUANTES
       ============================================================
       Bot√£o do WhatsApp e bot√£o para voltar ao topo da p√°gina.
       ============================================================ -->
  <a id="whatsapp-link" href="#" class="whatsapp-float" target="_blank" rel="noopener" aria-label="WhatsApp">
    <img src="imagens/whatsapp.png" alt="WhatsApp">
  </a>
  <button onclick="window.scrollTo({top: 0, behavior: 'smooth'});" class="topo-float" aria-label="Voltar ao topo">
    ‚ñ≤
  </button>

  <!-- ============================================================
       MODAL PERFIL MODERNO
       ============================================================ -->
  <div id="perfil-modal">
    <div class="perfil-card">
      <!-- Header do Perfil -->
      <div class="perfil-header">
        <div class="user-icon">üë§</div>
        <h2>Meu Perfil</h2>
        <button class="fechar-perfil" onclick="fecharPerfil()" aria-label="Fechar perfil">‚úï</button>
      </div>

      <!-- Conte√∫do do Perfil -->
      <div class="perfil-content">
        <!-- Dados principais -->
        <div id="perfil-dados"></div>

        <!-- Se√ß√£o de telefone -->
        <div class="perfil-section" id="telefone-section" style="display:none;">
          <h3>üì± Alterar Telefone</h3>
          <input type="text" id="perfil-telefone" placeholder="Digite seu telefone">
          <button id="btn-salvar-telefone" disabled class="btn-perfil">üíæ Salvar telefone</button>
          <div id="perfil-telefone-msg"></div>
        </div>

        <!-- Se√ß√£o de email -->
        <div class="perfil-section">
          <h3>‚úâÔ∏è Gerenciar Email</h3>
          <button id="btn-alterar-email" class="btn-perfil">üîÑ Alterar Email</button>
          
          <div id="alteracao-email" style="display:none;" class="perfil-section">
            <h3>üîê Alterar Email</h3>
            <div style="margin-bottom:16px;">
              <label style="font-size:12px;color:#6c757d;font-weight:600;">Email atual - C√≥digo de verifica√ß√£o:</label>
              <div style="display:flex;gap:12px;align-items:center;margin-top:8px;">
                <input type="text" id="codigo-email-atual" placeholder="C√≥digo do email atual" maxlength="6" style="flex:1;padding:8px 12px;border:2px solid #e9ecef;border-radius:8px;">
                <button type="button" id="enviar-codigo-atual" class="btn-small btn-warning">Enviar c√≥digo</button>
              </div>
            </div>
            <div id="novo-email-section" style="display:none;">
              <label style="font-size:12px;color:#6c757d;font-weight:600;">Novo email:</label>
              <input type="email" id="novo-email" placeholder="Digite o novo email" style="width:100%;padding:8px 12px;border:2px solid #e9ecef;border-radius:8px;margin:8px 0 12px 0;box-sizing:border-box;">
              <div style="display:flex;gap:12px;align-items:center;">
                <input type="text" id="codigo-email-novo" placeholder="C√≥digo do novo email" maxlength="6" style="flex:1;padding:8px 12px;border:2px solid #e9ecef;border-radius:8px;">
                <button type="button" id="verificar-email-novo" class="btn-small btn-warning">Verificar</button>
              </div>
            </div>
            <button type="button" id="cancelar-alteracao-email" class="btn-small btn-secondary" style="margin-top:12px;">Cancelar</button>
          </div>
        </div>

        <!-- A√ß√µes principais -->
        <div class="perfil-actions">
          <button id="btn-logout" class="btn-perfil">üö™ Sair da Conta</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ============================================================
       SCRIPTS: FIREBASE, CONTATO, REDES SOCIAIS, MENU MOBILE E PERFIL
       ============================================================
       Carrega dados do Firestore, ativa menus e bot√µes interativos.
       ============================================================ -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script>
    // Configura√ß√£o do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyDh8Rm-kx1HNbZewCv5D29EO3SMw_CDjyg",
      authDomain: "copn---maniclick.firebaseapp.com",
      projectId: "copn---maniclick",
      storageBucket: "copn---maniclick.appspot.com",
      messagingSenderId: "548110366122",
      appId: "1:548110366122:web:3e61878dd52d8657eda7d3",
      measurementId: "G-PFDZ47R5B0"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    // Carregar contato e redes sociais do Firestore (cole√ß√£o: contato, doc: info)
    db.collection("contato").doc("info").get().then((doc) => {
      if (doc.exists) {
        const data = doc.data();
        document.getElementById('contato-info').innerHTML = `
          <p><strong>Endere√ßo:</strong> ${data.endereco}</p>
          <p><strong>Telefone:</strong> ${data.telefone}</p>
          <p><strong>Hor√°rio:</strong> ${data.horario}</p>
        `;
        document.getElementById('icones').innerHTML = `
          <a href="${data.instagram}" target="_blank" rel="noopener" aria-label="Instagram">
            <img src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png" alt="Instagram">
          </a>
          <a href="${data.facebook}" target="_blank" rel="noopener" aria-label="Facebook">
            <img src="https://cdn-icons-png.flaticon.com/512/733/733547.png" alt="Facebook">
          </a>
          <a href="${data.tiktok}" target="_blank" rel="noopener" aria-label="TikTok">
            <img src="imagens/tiktok.png" alt="TikTok">
          </a>
        `;
        document.getElementById('whatsapp-link').href = `https://wa.me/${data.whatsapp}`;
      }
    });

    // ============================================================
    // MENU MOBILE E SUBMENU DE SERVI√áOS
    // ============================================================
    const btnHamburguer = document.getElementById('menu-hamburguer');
    const menuMobile = document.getElementById('menu-mobile');
    const btnFechar = document.getElementById('fechar-menu');
    btnHamburguer.addEventListener('click', () => {
      menuMobile.classList.add('ativo');
    });
    btnFechar.addEventListener('click', () => {
      menuMobile.classList.remove('ativo');
      // Fecha tamb√©m o submenu se estiver aberto
      const submenuServicos = document.querySelector('.menu-mobile .submenu-servicos');
      if (submenuServicos) submenuServicos.classList.remove('ativo');
    });

    // Submenu mobile de servi√ßos
    const abrirSubmenuMobile = document.getElementById('abrir-submenu-mobile');
    const submenuServicos = abrirSubmenuMobile.parentElement;

    abrirSubmenuMobile.addEventListener('click', function(e) {
      e.preventDefault();
      // Alterna abrir/fechar apenas este submenu
      submenuServicos.classList.toggle('ativo');
    });

    // Impede que clique nos links do submenu feche/abra o menu
    submenuServicos.querySelectorAll('.submenu-lista a').forEach(link => {
      link.addEventListener('click', function(e) {
        e.stopPropagation();
      });
    });

    // ============================================================
    // PERFIL: Troca menu, mostra modal, logout
    // ============================================================
    auth.onAuthStateChanged(function(user) {
      document.getElementById('menu-login').style.display = user ? 'none' : '';
      document.getElementById('menu-perfil').style.display = user ? '' : 'none';
      const menuLoginMobile = document.getElementById('menu-login-mobile');
      const menuPerfilMobile = document.getElementById('menu-perfil-mobile');
      if (menuLoginMobile) menuLoginMobile.style.display = user ? 'none' : '';
      if (menuPerfilMobile) menuPerfilMobile.style.display = user ? '' : 'none';
    });

    function abrirPerfil() {
      var modal = document.getElementById('perfil-modal');
      var dados = document.getElementById('perfil-dados');
      var user = auth.currentUser;
      if (!user) return;
      db.collection("usuarios").doc(user.uid).get().then(function(doc) {
        var info = doc.exists ? doc.data() : {};
        
        // Status de verifica√ß√£o
        const emailStatus = '<span class="field-status status-verified">‚úì Verificado</span>';
        // Telefone n√£o precisa mais de verifica√ß√£o SMS
        const telefoneStatus = '';
        
        dados.innerHTML = `
          <!-- Campo Nome -->
          <div class="perfil-field">
            <div class="field-icon">üë§</div>
            <div class="field-content">
              <div class="field-label">Nome Completo</div>
              <div class="field-value">${info.nome || user.displayName || 'N√£o informado'}</div>
            </div>
          </div>

          <!-- Campo Email -->
          <div class="perfil-field">
            <div class="field-icon">‚úâÔ∏è</div>
            <div class="field-content">
              <div class="field-label">Email</div>
              <div class="field-value">${user.email} ${emailStatus}</div>
            </div>
          </div>

          <!-- Campo Telefone -->
          <div class="perfil-field">
            <div class="field-icon">üì±</div>
            <div class="field-content">
              <div class="field-label">Telefone</div>
              <div class="field-value">
                ${info.telefone || 'N√£o informado'} ${info.telefone ? telefoneStatus : ''}
                <button type="button" class="btn-small btn-warning" onclick="editarTelefone()" style="margin-left:8px;">
                  ${info.telefone ? 'Alterar' : 'Adicionar'}
                </button>
              </div>
            </div>
          </div>
        `;
        
        // Fun√ß√£o para editar telefone
        window.editarTelefone = function() {
          const telefoneSection = document.getElementById('telefone-section');
          const inputTelefone = document.getElementById('perfil-telefone');
          const btnSalvar = document.getElementById('btn-salvar-telefone');
          const msg = document.getElementById('perfil-telefone-msg');
          
          telefoneSection.style.display = 'block';
          inputTelefone.value = info.telefone || '';
          
          // Configurar listener do input
          const telefoneOriginal = inputTelefone.value;
          inputTelefone.classList.remove('erro');
          
          inputTelefone.addEventListener('input', function() {
            const novoTel = this.value.trim();
            if (novoTel === telefoneOriginal) {
              btnSalvar.disabled = true;
              msg.style.display = 'none';
              this.classList.remove('erro');
            } else if (!telefoneValido(novoTel)) {
              btnSalvar.disabled = true;
              msg.textContent = 'Informe um telefone v√°lido (com DDD, apenas n√∫meros)';
              msg.style.display = 'block';
              this.classList.add('erro');
            } else {
              btnSalvar.disabled = false;
              msg.style.display = 'none';
              this.classList.remove('erro');
            }
          });
          
          inputTelefone.focus();
        };
        
        modal.style.display = 'flex';
      });
    }
    // Fun√ß√µes de verifica√ß√£o e utilit√°rios
    function gerarCodigoVerificacao() {
      return Math.floor(100000 + Math.random() * 900000).toString();
    }

    function enviarCodigoEmail(email, codigo) {
      console.log(`Email enviado para ${email}: C√≥digo ${codigo}`);
      alert(`C√≥digo Email simulado para ${email}: ${codigo}`);
      return Promise.resolve(true);
    }

    function telefoneValido(telefone) {
      return /^\d{10,11}$/.test(telefone.replace(/\D/g, ''));
    }

    // Objeto para controle de verifica√ß√µes no perfil
    var perfilVerificacao = {
      emailAtualVerificado: false,
      codigoEmailAtual: '',
      codigoEmailNovo: '',
      novoEmail: ''
    };

    // Event listeners para altera√ß√£o de email
    document.getElementById('btn-alterar-email').addEventListener('click', function() {
      document.getElementById('alteracao-email').style.display = 'block';
      this.style.display = 'none';
    });

    document.getElementById('cancelar-alteracao-email').addEventListener('click', function() {
      document.getElementById('alteracao-email').style.display = 'none';
      document.getElementById('btn-alterar-email').style.display = 'block';
      document.getElementById('novo-email-section').style.display = 'none';
      perfilVerificacao.emailAtualVerificado = false;
    });

    document.getElementById('enviar-codigo-atual').addEventListener('click', function() {
      const user = auth.currentUser;
      if (!user) return;
      
      perfilVerificacao.codigoEmailAtual = gerarCodigoVerificacao();
      enviarCodigoEmail(user.email, perfilVerificacao.codigoEmailAtual);
      
      this.textContent = 'C√≥digo enviado';
      this.disabled = true;
      setTimeout(() => {
        this.textContent = 'Reenviar c√≥digo';
        this.disabled = false;
      }, 30000);
    });

    document.getElementById('codigo-email-atual').addEventListener('input', function() {
      if (this.value.trim() === perfilVerificacao.codigoEmailAtual) {
        perfilVerificacao.emailAtualVerificado = true;
        document.getElementById('novo-email-section').style.display = 'block';
        this.style.borderColor = '#28a745';
        this.style.background = '#d4edda';
      } else {
        perfilVerificacao.emailAtualVerificado = false;
        document.getElementById('novo-email-section').style.display = 'none';
        this.style.borderColor = '';
        this.style.background = '';
      }
    });

    document.getElementById('novo-email').addEventListener('input', function() {
      const novoEmail = this.value.trim();
      if (novoEmail && novoEmail.includes('@') && novoEmail !== auth.currentUser.email) {
        perfilVerificacao.novoEmail = novoEmail;
        perfilVerificacao.codigoEmailNovo = gerarCodigoVerificacao();
        enviarCodigoEmail(novoEmail, perfilVerificacao.codigoEmailNovo);
      }
    });

    document.getElementById('verificar-email-novo').addEventListener('click', function() {
      const codigoDigitado = document.getElementById('codigo-email-novo').value.trim();
      if (codigoDigitado === perfilVerificacao.codigoEmailNovo && perfilVerificacao.emailAtualVerificado) {
        const user = auth.currentUser;
        user.updateEmail(perfilVerificacao.novoEmail).then(function() {
          return db.collection("usuarios").doc(user.uid).update({
            email: perfilVerificacao.novoEmail
          });
        }).then(function() {
          alert('Email alterado com sucesso!');
          fecharPerfil();
          window.location.reload();
        }).catch(function(error) {
          alert('Erro ao alterar email: ' + error.message);
        });
      } else {
        alert('C√≥digo incorreto ou email atual n√£o verificado.');
      }
    });

    // Fun√ß√£o para salvar telefone (sem verifica√ß√£o SMS)
    document.getElementById('btn-salvar-telefone').onclick = function() {
      var user = auth.currentUser;
      var inputTel = document.getElementById('perfil-telefone');
      var novoTelefone = inputTel.value.trim();
      var msg = document.getElementById('perfil-telefone-msg');
      
      if (!user || !telefoneValido(novoTelefone)) {
        inputTel.classList.add('erro');
        msg.textContent = 'Informe um telefone v√°lido (com DDD, apenas n√∫meros)';
        msg.style.display = 'block';
        return;
      }

      // Verificar se √© diferente do telefone atual
      db.collection("usuarios").doc(user.uid).get().then(function(doc) {
        const dadosAtuais = doc.exists ? doc.data() : {};
        if (dadosAtuais.telefone === novoTelefone) {
          alert('Este j√° √© seu telefone atual.');
          return;
        }

        // Salvar telefone diretamente sem verifica√ß√£o SMS
        this.disabled = true;
        this.textContent = 'Salvando...';
        
        db.collection("usuarios").doc(user.uid).update({ 
          telefone: novoTelefone,
          telefoneVerificado: false // N√£o verificado por SMS, mas aceito
        })
        .then(function() {
          alert('Telefone salvo com sucesso!');
          fecharPerfil();
        }.bind(this))
        .catch(function() {
          alert('Erro ao salvar telefone.');
          this.disabled = false;
          this.textContent = 'üíæ Salvar telefone';
        }.bind(this));
      }.bind(this));
    };

    function fecharPerfil() {
      document.getElementById('perfil-modal').style.display = 'none';
      document.getElementById('telefone-section').style.display = 'none';
      document.getElementById('perfil-telefone-msg').style.display = 'none';
      document.getElementById('alteracao-email').style.display = 'none';
      document.getElementById('btn-alterar-email').style.display = 'block';
      // Reset do estado de verifica√ß√£o (apenas email)
      perfilVerificacao.emailAtualVerificado = false;
      document.getElementById('novo-email-section').style.display = 'none';
    }
    document.getElementById('btn-logout').onclick = function() {
      auth.signOut().then(function() {
        fecharPerfil();
        window.location.reload();
      });
    };
  </script>
  <script src="contatenos.js"></script>
</body>
</html>